function Markdown(text){var parser;return"undefined"==typeof arguments.callee.parser?(parser=eval("new "+MARKDOWN_PARSER_CLASS+"()"),parser.init(),arguments.callee.parser=parser):parser=arguments.callee.parser,parser.transform(text)}function Markdown_Parser(){this.nested_brackets_depth=6,this.nested_url_parenthesis_depth=4,this.escape_chars="\\\\`*_{}[]()>#+-.!",this.document_gamut=[["stripLinkDefinitions",20],["runBasicBlockGamut",30]],this.block_gamut=[["doHeaders",10],["doHorizontalRules",20],["doLists",40],["doCodeBlocks",50],["doBlockQuotes",60]],this.span_gamut=[["parseSpan",-30],["doImages",10],["doAnchors",20],["doAutoLinks",30],["encodeAmpsAndAngles",40],["doItalicsAndBold",50],["doHardBreaks",60]],this.em_relist=[["","(?:(^|[^\\*])(\\*)(?=[^\\*])|(^|[^_])(_)(?=[^_]))(?=\\S|$)(?![\\.,:;]\\s)"],["*","((?:\\S|^)[^\\*])(\\*)(?!\\*)"],["_","((?:\\S|^)[^_])(_)(?!_)"]],this.strong_relist=[["","(?:(^|[^\\*])(\\*\\*)(?=[^\\*])|(^|[^_])(__)(?=[^_]))(?=\\S|$)(?![\\.,:;]\\s)"],["**","((?:\\S|^)[^\\*])(\\*\\*)(?!\\*)"],["__","((?:\\S|^)[^_])(__)(?!_)"]],this.em_strong_relist=[["","(?:(^|[^\\*])(\\*\\*\\*)(?=[^\\*])|(^|[^_])(___)(?=[^_]))(?=\\S|$)(?![\\.,:;]\\s)"],["***","((?:\\S|^)[^\\*])(\\*\\*\\*)(?!\\*)"],["___","((?:\\S|^)[^_])(___)(?!_)"]]}function MarkdownExtra_Parser(){this.fn_id_prefix="",this.fn_link_title=MARKDOWN_FN_LINK_TITLE,this.fn_backlink_title=MARKDOWN_FN_BACKLINK_TITLE,this.fn_link_class=MARKDOWN_FN_LINK_CLASS,this.fn_backlink_class=MARKDOWN_FN_BACKLINK_CLASS,this.predef_abbr={},this.footnotes={},this.footnotes_ordered=[],this.abbr_desciptions={},this.abbr_word_re="",this.footnote_counter=1,this.block_tags_re="p|div|h[1-6]|blockquote|pre|table|dl|ol|ul|address|form|fieldset|iframe|hr|legend",this.context_block_tags_re="script|noscript|math|ins|del",this.contain_span_tags_re="p|h[1-6]|li|dd|dt|td|th|legend|address",this.clean_tags_re="script|math",this.auto_close_tags_re="hr|img",this.em_relist=[["","(?:(^|[^\\*])(\\*)(?=[^\\*])|(^|[^a-zA-Z0-9_])(_)(?=[^_]))(?=\\S|$)(?![\\.,:;]\\s)"],["*","((?:\\S|^)[^\\*])(\\*)(?!\\*)"],["_","((?:\\S|^)[^_])(_)(?![a-zA-Z0-9_])"]],this.strong_relist=[["","(?:(^|[^\\*])(\\*\\*)(?=[^\\*])|(^|[^a-zA-Z0-9_])(__)(?=[^_]))(?=\\S|$)(?![\\.,:;]\\s)"],["**","((?:\\S|^)[^\\*])(\\*\\*)(?!\\*)"],["__","((?:\\S|^)[^_])(__)(?![a-zA-Z0-9_])"]],this.em_strong_relist=[["","(?:(^|[^\\*])(\\*\\*\\*)(?=[^\\*])|(^|[^a-zA-Z0-9_])(___)(?=[^_]))(?=\\S|$)(?![\\.,:;]\\s)"],["***","((?:\\S|^)[^\\*])(\\*\\*\\*)(?!\\*)"],["___","((?:\\S|^)[^_])(___)(?![a-zA-Z0-9_])"]],this.escape_chars+=":|",this.document_gamut.push(["doFencedCodeBlocks",5]),this.document_gamut.push(["stripFootnotes",15]),this.document_gamut.push(["stripAbbreviations",25]),this.document_gamut.push(["appendFootnotes",50]),this.block_gamut.push(["doFencedCodeBlocks",5]),this.block_gamut.push(["doTables",15]),this.block_gamut.push(["doDefLists",45]),this.span_gamut.push(["doFootnotes",5]),this.span_gamut.push(["doAbbreviations",70])}var MARKDOWN_VERSION="1.0.1o",MARKDOWNEXTRA_VERSION="1.2.5",MARKDOWN_EMPTY_ELEMENT_SUFFIX=" />",MARKDOWN_TAB_WIDTH=4,MARKDOWN_FN_LINK_TITLE="",MARKDOWN_FN_BACKLINK_TITLE="",MARKDOWN_FN_LINK_CLASS="",MARKDOWN_FN_BACKLINK_CLASS="",MARKDOWN_WP_POSTS=!0,MARKDOWN_WP_COMMENTS=!0;MARKDOWN_PARSER_CLASS="MarkdownExtra_Parser",Markdown_Parser.prototype.init=function(){function t(t,e){return t=t[1],e=e[1],t>e?1:e>t?-1:0}this.prepareItalicsAndBold(),this.nested_brackets_re="(?:[^\\]]*?)",this.nested_url_parenthesis_re="(?:[^\\)\\s]*?)";for(var e=[],r=0;r<this.escape_chars.length;r++)e.push(this._php_preg_quote(this.escape_chars.charAt(r)));this.escape_chars_re="["+e.join("")+"]",this.empty_element_suffix=MARKDOWN_EMPTY_ELEMENT_SUFFIX,this.tab_width=MARKDOWN_TAB_WIDTH,this.no_markup=!1,this.no_entities=!1,this.predef_urls={},this.predef_titles={},this.document_gamut.sort(t),this.block_gamut.sort(t),this.span_gamut.sort(t),this.urls={},this.titles={},this.html_hashes={},this.in_anchor=!1},Markdown_Parser.prototype.__wrapSTXETX__=function(t){return""!=t.charAt(0)&&(t=""+t),""!=t.charAt(t.length-1)&&(t+=""),t},Markdown_Parser.prototype.__unwrapSTXETX__=function(t){return""==t.charAt(0)&&(t=t.substr(1)),""==t.charAt(t.length-1)&&(t=t.substr(0,t.length-1)),t},Markdown_Parser.prototype._php_preg_quote=function(t){return arguments.callee.sRE||(arguments.callee.sRE=/(\/|\.|\*|\+|\?|\||\(|\)|\[|\]|\{|\}\\)/g),t.replace(arguments.callee.sRE,"\\$1")},Markdown_Parser.prototype._php_str_repeat=function(t,e){for(var r=t,n=1;e>n;n++)r+=t;return r},Markdown_Parser.prototype._php_trim=function(t,e){var r=e||"   \n\r";return t.replace(new RegExp("^["+r+"]*|["+r+"]*$","g"),"")},Markdown_Parser.prototype._php_rtrim=function(t,e){var r=e||"     \n\r";return t.replace(new RegExp("["+r+"]*$","g"),"")},Markdown_Parser.prototype._php_htmlspecialchars_ENT_NOQUOTES=function(t){return t.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;")},Markdown_Parser.prototype.setup=function(){this.urls=this.predef_urls,this.titles=this.predef_titles,this.html_hashes={},this.in_anchor=!1},Markdown_Parser.prototype.teardown=function(){this.urls={},this.titles={},this.html_hashes={}},Markdown_Parser.prototype.transform=function(t){this.setup(),t=t.replace(/^\xEF\xBB\xBF|\x1A/,""),t=t.replace(/\r\n?/g,"\n",t),t+="\n\n",t=this.detab(t),t=this.hashHTMLBlocks(t),t=t.replace(/^[ ]+$/m,"");for(var e=0;e<this.document_gamut.length;e++){var r=this[this.document_gamut[e][0]];r?t=r.call(this,t):console.log(this.document_gamut[e][0]+" not implemented")}return this.teardown(),t+"\n"},Markdown_Parser.prototype.hashHTMLBlocks=function(t){if(this.no_markup)return t;var e=this.tab_width-1,r="ins|del",n="p|div|h[1-6]|blockquote|pre|table|dl|ol|ul|address|script|noscript|form|fieldset|iframe|math",a=4,s='(?:\\s(?:[^>"/]+|/+(?!>)|"[^"]*"|\'[^\']*\')*)?',o=this._php_str_repeat("(?:[^<]+|<\\2"+s+"(?:/>|>",a)+".*?"+this._php_str_repeat("</\\2\\s*>)|<(?!/\\2\\s*>))*",a),i=o.replace("\\2","\\3"),h=new RegExp("(?:(?:(?:\\n\\n)|(?:\\x02)\\n?)([ ]{0,"+e+"}<("+n+")"+s+">"+o+"</\\2>[ ]*(?=\\n+|\\n*\\x03)|[ ]{0,"+e+"}<("+r+")"+s+">[ ]*\\n"+i+"</\\3>[ ]*(?=\\n+|\\n*\\x03)|[ ]{0,"+e+"}<(hr)"+s+"/?>[ ]*(?=\\n{2,}|\\n*\\x03)|[ ]{0,"+e+"}(?:<!--.*?-->)[ ]*(?=\\n{2,}|\\n*\\x03)|[ ]{0,"+e+"}(?:<([?%]).*?\\2>)[ ]*(?=\\n{2,}|\\n*\\x03)))","mig"),_=this;return t=this.__wrapSTXETX__(t),t=t.replace(h,function(t,e){var r=_.hashBlock(e);return"\n\n"+r+"\n\n"}),t=this.__unwrapSTXETX__(t)},Markdown_Parser.prototype.hashPart=function(t,e){"undefined"==typeof e&&(e="X"),t=this.unhash(t),"undefined"==typeof arguments.callee.i&&(arguments.callee.i=0);var r=e+""+ ++arguments.callee.i+e;return this.html_hashes[r]=t,r},Markdown_Parser.prototype.hashBlock=function(t){return this.hashPart(t,"B")},Markdown_Parser.prototype.stripLinkDefinitions=function(t){var e=this.tab_width-1,r=this;return t=this.__wrapSTXETX__(t),t=t.replace(new RegExp("^[ ]{0,"+e+'}\\[(.+)\\][ ]?:[ ]*\\n?[ ]*(?:<(.+?)>|(\\S+?))[ ]*\\n?[ ]*(?:["\\(](.*?)["\\)][ ]*)?(?:\\n+|\\n*(?=\\x03))',"mg"),function(t,e,n,a,s){var o=e.toLowerCase(),i=n?n:a;return r.urls[o]=i,r.titles[o]=s,""}),t=this.__unwrapSTXETX__(t)},Markdown_Parser.prototype.runBlockGamut=function(t){return t=this.hashHTMLBlocks(t),this.runBasicBlockGamut(t)},Markdown_Parser.prototype.runBasicBlockGamut=function(t){for(var e=0;e<this.block_gamut.length;e++){var r=this[this.block_gamut[e][0]];r?t=r.call(this,t):console.log(this.block_gamut[e][0]+" not implemented")}return t=this.formParagraphs(t)},Markdown_Parser.prototype.doHorizontalRules=function(t){var e=this;return t.replace(new RegExp("^[ ]{0,3}([-\\*_])(?:[ ]{0,2}\\1){2,}[ ]*$","mg"),function(){return"\n"+e.hashBlock("<hr"+e.empty_element_suffix)+"\n"})},Markdown_Parser.prototype.runSpanGamut=function(t){for(var e=0;e<this.span_gamut.length;e++){var r=this[this.span_gamut[e][0]];r?t=r.call(this,t):console.log(this.span_gamut[e][0]+" not implemented")}return t},Markdown_Parser.prototype.doHardBreaks=function(t){var e=this;return t.replace(/ {2,}\n/gm,function(){return e.hashPart("<br"+e.empty_element_suffix+"\n")})},Markdown_Parser.prototype.doAnchors=function(t){if(this.in_anchor)return t;this.in_anchor=!0;var e=this,r=function(t,r,n,a){("string"!=typeof a||""===a)&&(a=n),a=a.toLowerCase(),a=a.replace(/[ ]?\n/," ");var s;if("undefined"!=typeof e.urls[a]){var o=e.urls[a];if(o=e.encodeAttribute(o),s='<a href="'+o+'"',"undefined"!=typeof e.titles[a]){var i=e.titles[a];i=e.encodeAttribute(i),s+=' title="'+i+'"'}n=e.runSpanGamut(n),s+=">"+n+"</a>",s=e.hashPart(s)}else s=r;return s};return t=t.replace(new RegExp("(\\[("+this.nested_brackets_re+")\\][ ]?(?:\\n[ ]*)?\\[(.*?)\\])","mg"),r),t=t.replace(new RegExp("(\\[("+this.nested_brackets_re+")\\]\\([ \\n]*(?:<(.+?)>|("+this.nested_url_parenthesis_re+"))[ \\n]*((['\"])(.*?)\\6[ \\n]*)?\\))","mg"),function(t,r,n,a,s,o,i,h){n=e.runSpanGamut(n);var _=a?a:s;_=e.encodeAttribute(_);var p='<a href="'+_+'"';return"undefined"!=typeof h&&""!==h&&(h=e.encodeAttribute(h),p+=' title="'+h+'"'),n=e.runSpanGamut(n),p+=">"+n+"</a>",e.hashPart(p)}),t=t.replace(new RegExp("(\\[([^\\[\\]]+)\\])","mg"),r),this.in_anchor=!1,t},Markdown_Parser.prototype.doImages=function(t){var e=this;return t=t.replace(new RegExp("(!\\[("+this.nested_brackets_re+")\\][ ]?(?:\\n[ ]*)?\\[(.*?)\\])","mg"),function(t,r,n,a){a=a.toLowerCase(),("string"!=typeof a||""===a)&&(a=n.toLowerCase()),n=e.encodeAttribute(n);var s;if("undefined"!=typeof e.urls[a]){var o=e.encodeAttribute(e.urls[a]);if(s='<img src="'+o+'" alt="'+n+'"',"undefined"!=typeof e.titles[a]){var i=e.titles[a];i=e.encodeAttribute(i),s+=' title="'+i+'"'}s+=e.empty_element_suffix,s=e.hashPart(s)}else s=r;return s}),t=t.replace(new RegExp("(!\\[("+this.nested_brackets_re+")\\]\\s?\\([ \\n]*(?:<(\\S*)>|("+this.nested_url_parenthesis_re+"))[ \\n]*((['\"])(.*?)\\6[ \\n]*)?\\))","mg"),function(t,r,n,a,s,o,i,h){var _=a?a:s;n=e.encodeAttribute(n),_=e.encodeAttribute(_);var p='<img src="'+_+'" alt="'+n+'"';return"undefined"!=typeof h&&""!==h&&(h=e.encodeAttribute(h),p+=' title="'+h+'"'),p+=e.empty_element_suffix,e.hashPart(p)})},Markdown_Parser.prototype.doHeaders=function(t){var e=this;return t=t.replace(/^(.+?)[ ]*\n(=+|-+)[ ]*\n+/gm,function(t,r,n){if("-"==n&&r.match(/^-(?: |$)/))return t;var a="="==n.charAt(0)?1:2,s="<h"+a+">"+e.runSpanGamut(r)+"</h"+a+">";return"\n"+e.hashBlock(s)+"\n\n"}),t=t.replace(new RegExp("^(\\#{1,6})[ ]*(.+?)[ ]*\\#*\\n+","mg"),function(t,r,n){var a=r.length,s="<h"+a+">"+e.runSpanGamut(n)+"</h"+a+">";return"\n"+e.hashBlock(s)+"\n\n"})},Markdown_Parser.prototype.doLists=function(t){for(var e=this.tab_width-1,r="[\\*\\+-]",n="\\d+[\\.]",a=this,s=function(t,e,s,o,i){var h=i.match(r)?"ul":"ol",_="ul"==h?r:n;e+="\n";var p=a.processListItems(e,_);return p=a.hashBlock("<"+h+">\n"+p+"</"+h+">"),"\n"+p+"\n\n"},o=[[r,n],[n,r]],i=0;i<o.length;i++){var h=o[i][0],_=o[i][1],p="((([ ]{0,"+e+"})("+h+")[ ]+)[\\s\\S]+?((?=\\x03)|\\n{2,}(?=\\S)(?![ ]*"+h+"[ ]+)|(?=\\n\\3"+_+"[ ]+)))";t=this.__wrapSTXETX__(t),t=this.list_level?t.replace(new RegExp("^"+p,"mg"),s):t.replace(new RegExp("(?:(?=\\n)\\n|\\x02\\n?)"+p,"mg"),s),t=this.__unwrapSTXETX__(t)}return t},Markdown_Parser.prototype.processListItems=function(t,e){"undefined"==typeof this.list_level&&(this.list_level=0),this.list_level++,t=this.__wrapSTXETX__(t),t=t.replace(/\n{2,}(?=\x03)/m,"\n"),t=this.__unwrapSTXETX__(t);var r=this;return t=this.__wrapSTXETX__(t),t=t.replace(new RegExp("(\\n)?([ ]*)("+e+"(?:[ ]+|(?=\\n)))([\\s\\S]*?)(?:(\\n+(?=\\n))|\\n)(?=\\n*(\\x03|\\2("+e+")(?:[ ]+|(?=\\n))))","gm"),function(t,e,n,a,s,o){return e||o||s.match(/\n{2,}/)?(s=n+r._php_str_repeat(" ",a.length)+s,s=r.runBlockGamut(r.outdent(s)+"\n")):(s=r.doLists(r.outdent(s)),s=s.replace(/\n+$/m,""),s=r.runSpanGamut(s)),"<li>"+s+"</li>\n"}),t=this.__unwrapSTXETX__(t),this.list_level--,t},Markdown_Parser.prototype.doCodeBlocks=function(t){var e=this;return t=this.__wrapSTXETX__(t),t=t.replace(new RegExp("(?:\\n\\n|(?=\\x02)\\n?)((?:^[ ]{"+this.tab_width+",}.*\\n+)+)((?=[ ]{0,"+this.tab_width+"}\\S)|(?:\\n*(?=\\x03)))","mg"),function(t,r){return r=e.outdent(r),r=e._php_htmlspecialchars_ENT_NOQUOTES(r),r=e.__wrapSTXETX__(r),r=r.replace(/(?=\x02)\n+|\n+(?=\x03)/g,""),r=e.__unwrapSTXETX__(r),r="<pre><code>"+r+"\n</code></pre>","\n\n"+e.hashBlock(r)+"\n\n"}),t=this.__unwrapSTXETX__(t)},Markdown_Parser.prototype.makeCodeSpan=function(t){return t=this._php_htmlspecialchars_ENT_NOQUOTES(this._php_trim(t)),this.hashPart("<code>"+t+"</code>")},Markdown_Parser.prototype.prepareItalicsAndBold=function(){this.em_strong_prepared_relist={};for(var t=0;t<this.em_relist.length;t++)for(var e=this.em_relist[t][0],r=this.em_relist[t][1],n=0;n<this.strong_relist.length;n++){for(var a=this.strong_relist[n][0],s=this.strong_relist[n][1],o=[],i=0;i<this.em_strong_relist.length;i++){var h=this.em_strong_relist[i][0],_=this.em_strong_relist[i][1];e+a==h&&o.push(_)}o.push(r),o.push(s);var p=new RegExp("("+o.join("|")+")");this.em_strong_prepared_relist["rx_"+e+a]=p}},Markdown_Parser.prototype.doItalicsAndBold=function(t){for(var e="",r="",n=!1,a=[""],s=[],o="";;){var i=this.em_strong_prepared_relist["rx_"+e+r],h=t.match(i);if(h){for(var _=RegExp.leftContext,p=RegExp.rightContext,c="",l=h[1],u=2;u<h.length;u+=2)if("undefined"!=typeof h[u]&&""!=h[u]){c=h[u],l=h[u+1];break}a[0]+=_+c,o=l,t=p}else a[0]+=t,o="",t="";if(""==o){for(;s.length>0&&s[0].length>0;){a[1]+=s.shift();var d=a.shift();a[0]+=d}break}var f,g,E=o.length;if(n)3==E?(s.shift(),g=a.shift(),g=this.runSpanGamut(g),g="<strong><em>"+g+"</em></strong>",a[0]+=this.hashPart(g),e="",r=""):(s[0]=this._php_str_repeat(o.charAt(0),3-E),f=2==E?"strong":"em",g=a[0],g=this.runSpanGamut(g),g="<"+f+">"+g+"</"+f+">",a[0]=this.hashPart(g),"strong"==f?r="":e=""),n=!1;else if(3==E)if(""!=e)for(var m=0;2>m;++m){var A=s.shift();f=2==A.length?"strong":"em",g=a.shift(),g=this.runSpanGamut(g),g="<"+f+">"+g+"</"+f+">",a[0]=this.hashPart(g),"strong"==f?r="":e=""}else e=o.charAt(0),r=e+e,s.unshift(o),a.unshift(""),n=!0;else if(2==E)if(""!=r){if(1==s[0].length){a[1]+=s.shift();var d=a.shift();a[0]+=d}s.shift(),g=a.shift(),g=this.runSpanGamut(g),g="<strong>"+g+"</strong>",a[0]+=this.hashPart(g),r=""}else s.unshift(o),a.unshift(""),r=o;else""!=e?1==s[0].length?(s.shift(),g=a.shift(),g=this.runSpanGamut(g),g="<em>"+g+"</em>",a[0]+=this.hashPart(g),e=""):a[0]+=o:(s.unshift(o),a.unshift(""),e=o)}return a[0]},Markdown_Parser.prototype.doBlockQuotes=function(t){var e=this;return t=t.replace(new RegExp("((?:^[ ]*>[ ]?.+\\n(.+\\n)*\\n*)+)","mg"),function(t,r){return r=r.replace(/^[ ]*>[ ]?|^[ ]+$/gm,""),r=e.runBlockGamut(r),r=r.replace(/^/gm,"  "),r=r.replace(/(\\s*<pre>[\\s\\S]+?<\/pre>)/gm,function(t,e){return e=e.replace(/^  /m,"")}),"\n"+e.hashBlock("<blockquote>\n"+r+"\n</blockquote>")+"\n\n"})},Markdown_Parser.prototype.formParagraphs=function(t){t=this.__wrapSTXETX__(t),t=t.replace(/(?:\x02)\n+|\n+(?:\x03)/g,""),t=this.__unwrapSTXETX__(t);for(var e=t.split(/\n{2,}/m),r=0;r<e.length;r++){var n=e[r];if(""==n);else if(n.match(/^B\x1A[0-9]+B$/)){var a=n,s=this.html_hashes[a];a=s,e[r]=a}else n=this.runSpanGamut(n),n=n.replace(/^([ ]*)/,"<p>"),n+="</p>",e[r]=this.unhash(n)}return e.join("\n\n")},Markdown_Parser.prototype.encodeAttribute=function(t){return t=this.encodeAmpsAndAngles(t),t=t.replace(/"/g,"&quot;")},Markdown_Parser.prototype.encodeAmpsAndAngles=function(t){return t=this.no_entities?t.replace(/&/g,"&amp;"):t.replace(/&(?!#?[xX]?(?:[0-9a-fA-F]+|\w+);)/,"&amp;"),t=t.replace(/</g,"&lt;")},Markdown_Parser.prototype.doAutoLinks=function(t){var e=this;return t=t.replace(/<((https?|ftp|dict):[^'">\s]+)>/i,function(t,r){var n=e.encodeAttribute(r),a='<a href="'+n+'">'+n+"</a>";return e.hashPart(a)}),t=t.replace(new RegExp('<(?:mailto:)?((?:[-!#$%&\'*+/=?^_`.{|}~\\w\\x80-\\xFF]+|".*?")\\@(?:[-a-z0-9\\x80-\\xFF]+(\\.[-a-z0-9\\x80-\\xFF]+)*\\.[a-z]+|\\[[\\d.a-fA-F:]+\\]))>',"i"),function(t,r){var n=e.encodeEmailAddress(r);return e.hashPart(n)})},Markdown_Parser.prototype.encodeEmailAddress=function(t){function e(t){var e=0;e=-1^e;for(var n=0;n<t.length;++n){var a=255&(e^t.charCodeAt(n)),s="0x"+r[a];e=e>>>8^s}return(-1^e)>>>0}"undefined"==typeof arguments.callee.crctable&&(arguments.callee.crctable="00000000 77073096 EE0E612C 990951BA 076DC419 706AF48F E963A535 9E6495A3 0EDB8832 79DCB8A4 E0D5E91E 97D2D988 09B64C2B 7EB17CBD E7B82D07 90BF1D91 1DB71064 6AB020F2 F3B97148 84BE41DE 1ADAD47D 6DDDE4EB F4D4B551 83D385C7 136C9856 646BA8C0 FD62F97A 8A65C9EC 14015C4F 63066CD9 FA0F3D63 8D080DF5 3B6E20C8 4C69105E D56041E4 A2677172 3C03E4D1 4B04D447 D20D85FD A50AB56B 35B5A8FA 42B2986C DBBBC9D6 ACBCF940 32D86CE3 45DF5C75 DCD60DCF ABD13D59 26D930AC 51DE003A C8D75180 BFD06116 21B4F4B5 56B3C423 CFBA9599 B8BDA50F 2802B89E 5F058808 C60CD9B2 B10BE924 2F6F7C87 58684C11 C1611DAB B6662D3D 76DC4190 01DB7106 98D220BC EFD5102A 71B18589 06B6B51F 9FBFE4A5 E8B8D433 7807C9A2 0F00F934 9609A88E E10E9818 7F6A0DBB 086D3D2D 91646C97 E6635C01 6B6B51F4 1C6C6162 856530D8 F262004E 6C0695ED 1B01A57B 8208F4C1 F50FC457 65B0D9C6 12B7E950 8BBEB8EA FCB9887C 62DD1DDF 15DA2D49 8CD37CF3 FBD44C65 4DB26158 3AB551CE A3BC0074 D4BB30E2 4ADFA541 3DD895D7 A4D1C46D D3D6F4FB 4369E96A 346ED9FC AD678846 DA60B8D0 44042D73 33031DE5 AA0A4C5F DD0D7CC9 5005713C 270241AA BE0B1010 C90C2086 5768B525 206F85B3 B966D409 CE61E49F 5EDEF90E 29D9C998 B0D09822 C7D7A8B4 59B33D17 2EB40D81 B7BD5C3B C0BA6CAD EDB88320 9ABFB3B6 03B6E20C 74B1D29A EAD54739 9DD277AF 04DB2615 73DC1683 E3630B12 94643B84 0D6D6A3E 7A6A5AA8 E40ECF0B 9309FF9D 0A00AE27 7D079EB1 F00F9344 8708A3D2 1E01F268 6906C2FE F762575D 806567CB 196C3671 6E6B06E7 FED41B76 89D32BE0 10DA7A5A 67DD4ACC F9B9DF6F 8EBEEFF9 17B7BE43 60B08ED5 D6D6A3E8 A1D1937E 38D8C2C4 4FDFF252 D1BB67F1 A6BC5767 3FB506DD 48B2364B D80D2BDA AF0A1B4C 36034AF6 41047A60 DF60EFC3 A867DF55 316E8EEF 4669BE79 CB61B38C BC66831A 256FD2A0 5268E236 CC0C7795 BB0B4703 220216B9 5505262F C5BA3BBE B2BD0B28 2BB45A92 5CB36A04 C2D7FFA7 B5D0CF31 2CD99E8B 5BDEAE1D 9B64C2B0 EC63F226 756AA39C 026D930A 9C0906A9 EB0E363F 72076785 05005713 95BF4A82 E2B87A14 7BB12BAE 0CB61B38 92D28E9B E5D5BE0D 7CDCEFB7 0BDBDF21 86D3D2D4 F1D4E242 68DDB3F8 1FDA836E 81BE16CD F6B9265B 6FB077E1 18B74777 88085AE6 FF0F6A70 66063BCA 11010B5C 8F659EFF F862AE69 616BFFD3 166CCF45 A00AE278 D70DD2EE 4E048354 3903B3C2 A7672661 D06016F7 4969474D 3E6E77DB AED16A4A D9D65ADC 40DF0B66 37D83BF0 A9BCAE53 DEBB9EC5 47B2CF7F 30B5FFE9 BDBDF21C CABAC28A 53B39330 24B4A3A6 BAD03605 CDD70693 54DE5729 23D967BF "+"B3667A2E C4614AB8 5D681B02 2A6F2B94 B40BBE37 C30C8EA1 5A05DF1B 2D02EF8D".split(" "));var r=arguments.callee.crctable;t="mailto:"+t;var n,a=[];for(n=0;n<t.length;n++)a.push(t.charAt(n));var s=Math.floor(Math.abs(e(t)/t.length));for(n=0;n<a.length;n++){var o=a[n],i=o.charCodeAt(0);if(128>i){var h=s*(1+n)%100;h>90&&"@"!=o||(a[n]=45>h?"&#x"+i.toString(16)+";":"&#"+i.toString(10)+";")}}t=a.join("");var _=a.splice(7,a.length-1).join("");return t='<a href="'+t+'">'+_+"</a>"},Markdown_Parser.prototype.parseSpan=function(t){for(var e="",r=new RegExp("(\\\\"+this.escape_chars_re+"|`+"+(this.no_markup?"":"|<!--.*?-->|<\\?.*?\\?>|<%.*?%>|<[/!$]?[-a-zA-Z0-9:_]+(?:\\s(?:[^\"'>]+|\"[^\"]*\"|'[^']*')*)?>")+")");;){var n=t.match(r);if(!n){e+=t;break}if(RegExp.leftContext&&(e+=RegExp.leftContext),"`"!=RegExp.lastMatch.charAt(0)||"\\"!=RegExp.leftContext.charAt(RegExp.leftContext.length-1)){var a=this.handleSpanToken(RegExp.lastMatch,RegExp.rightContext);e+=a[0],t=a[1]}else e+=RegExp.lastMatch,t=RegExp.rightContext}return e},Markdown_Parser.prototype.handleSpanToken=function(t,e){switch(t.charAt(0)){case"\\":return[this.hashPart("&#"+t.charCodeAt(1)+";"),e];case"`":if(e.match(new RegExp("^([\\s\\S]*?[^`])"+this._php_preg_quote(t)+"(?!`)([\\s\\S]*)$","m"))){var r=RegExp.$1;e=RegExp.$2;var n=this.makeCodeSpan(r);return[this.hashPart(n),e]}return[t,e];default:return[this.hashPart(t),e]}},Markdown_Parser.prototype.outdent=function(t){return t.replace(new RegExp("^(\\t|[ ]{1,"+this.tab_width+"})","mg"),"")},Markdown_Parser.prototype.detab=function(t){var e=this;return t.replace(/^.*\t.*$/gm,function(t){var r=t.split("    ");t=r.shift();for(var n=0;n<r.length;n++){var a=r[n],s=e.tab_width-t.length%e.tab_width;t+=e._php_str_repeat(" ",s)+a}return t})},Markdown_Parser.prototype.unhash=function(t){var e=this;return t.replace(/(.)\x1A[0-9]+\1/g,function(t){return e.html_hashes[t]})},MarkdownExtra_Parser.prototype=new Markdown_Parser,MarkdownExtra_Parser.prototype.setup=function(){this.constructor.prototype.setup.call(this),this.footnotes={},this.footnotes_ordered=[],this.abbr_desciptions={},this.abbr_word_re="",this.footnote_counter=1;for(var t in this.predef_abbr){var e=this.predef_abbr[t];""!=this.abbr_word_re&&(this.abbr_word_re+="|"),this.abbr_word_re+=this._php_preg_quote(t),this.abbr_desciptions[t]=this._php_trim(e)}},MarkdownExtra_Parser.prototype.teardown=function(){this.footnotes={},this.footnotes_ordered=[],this.abbr_desciptions={},this.abbr_word_re="",this.constructor.prototype.teardown.call(this)},MarkdownExtra_Parser.prototype.hashHTMLBlocks=function(t){var e=this._hashHTMLBlocks_inMarkdown(t);return t=e[0]},MarkdownExtra_Parser.prototype._hashHTMLBlocks_inMarkdown=function(t,e,r,n){if("undefined"==typeof e&&(e=0),"undefined"==typeof r&&(r=""),"undefined"==typeof n&&(n=!1),""===t)return["",""];var a,s=/(?:^\n?|\n\n)*$/,o=new RegExp("^([ ]*<!--.*?-->)?[ ]*\\n","m"),i=new RegExp("(</?("+this.block_tags_re+"|"+this.context_block_tags_re+"|"+this.clean_tags_re+"|(?!\\s)"+r+")(?:(?=[\\s\"'/a-zA-Z0-9])(\".*?\"|'.*?'|.+?)*?)?>|<!--.*?-->|<\\?.*?\\?>|<%.*?%>|<!\\[CDATA\\[.*?\\]\\]>|`+"+(n?"":"|(?:^[ ]*\\n|^|\\n[ ]*\\n)[ ]{"+(e+4)+"}[^\\n]*\\n(?=(?:[ ]{"+(e+4)+"}[^\\n]*|[ ]*)\\n)*|(?:^|\\n)[ ]{0,"+e+"}~~~+[ ]*\\n")+")","m"),h=0,_="";do{var p,c=t.match(i);if(p=c?[RegExp.leftContext,RegExp.lastMatch,RegExp.rightContext]:[t],n){var l=this.hashPart("",":"),u=l+"\n";p[0]=l+p[0].replace(/\n/g,u)+l}if(_+=p[0],!c){t="";break}var d=p[1];t=p[2];var f,g,E=this._php_preg_quote(d);if("`"==d.charAt(0))E=this._php_preg_quote(d),-1!=t.substr(1).indexOf("`")&&(a=t.match(new RegExp("^(.+?|\\n[^\\n])*?[^`]"+E+"[^`]")))?(_+=d+a[0],t=t.substr(a[0].length)):_+=d;else if(d.match(new RegExp("^\\n?[ ]{0,"+(e+3)+"}~")))E=this._php_preg_quote(this._php_trim(d)),(a=t.match(new RegExp("^(?:.*\\n)+?[ ]{0,"+e+"}"+E+"[ ]*\\n")))?(_+=d+a[0],t=t.substr(a[0].length)):_+=d;else if("\n"==d.charAt(0)||" "==d.charAt(0))_+=d;else if(d.match(new RegExp("^<(?:"+this.block_tags_re+")\\b"))||d.match(new RegExp("^<(?:"+this.context_block_tags_re+")\\b"))&&_.match(s)&&t.match(o))f=this._hashHTMLBlocks_inHTML(d+t,this.hashBlock,!0),g=f[0],t=f[1],_+="\n\n"+g+"\n\n";else if(d.match(new RegExp("^<(?:"+this.clean_tags_re+")\\b"))||"!"==d.charAt(1)||"?"==d.charAt(1))f=this._hashHTMLBlocks_inHTML(d+t,this.hashClean,!1),g=f[0],t=f[1],_+=g;else if(""!==r&&d.match(new RegExp("^</?(?:"+r+")\\b"))){if("/"==d.charAt(1)?h--:"/"!=d.charAt(d.length-2)&&h++,0>h){t=d+t;break}_+=d}else _+=d}while(h>=0);return[_,t]},MarkdownExtra_Parser.prototype._hashHTMLBlocks_inHTML=function(t,e,r){if(""===t)return["",""];var n,a=new RegExp("\\s*markdown\\s*=\\s*(?:([\"'])(.*?)\\1|([^\\s>]*))()"),s=new RegExp("(</?[\\w:$]+(?:(?=[\\s\"'/a-zA-Z0-9])(?:\".*?\"|'.*?'|.+?)*?)?>|<!--.*?-->|<\\?.*?\\?>|<%.*?%>|<!\\[CDATA\\[.*?\\]\\]>)"),o=t,i=0,h="",_="",p="";(n=t.match(/^<([\w:$]*)\b/))&&(p=n[1]);do{var c=t.match(s);if(!c)return[o.charAt(0),o.substr(1)];var l=[RegExp.leftContext,RegExp.lastMatch,RegExp.rightContext];h+=l[0];var u=l[1];if(t=l[2],u.match(new RegExp("^</?(?:"+this.auto_close_tags_re+")\\b"))||"!"==u.charAt(1)||"?"==u.charAt(1))h+=u;else{u.match(new RegExp("^</?"+p+"\\b"))&&("/"==u.charAt(1)?i--:"/"!=u.charAt(u.length-2)&&i++);var d;if(r&&(d=u.match(a))&&(d[2]+d[3]).match(/^1|block|span$/)){u=u.replace(a,""),this.mode=d[2]+d[3];var f,g="span"==this.mode||"block"!=this.mode&&u.match(new RegExp("^<(?:"+this.contain_span_tags_re+")\\b"));f=(n=h.match(/(?:^|\n)( *?)(?! ).*?$/))?n[1].length:0,h+=u,_+=e.call(this,h),n=u.match(/^<([\w:$]*)\b/);var E=n[1],m=this._hashHTMLBlocks_inMarkdown(t,f,E,g);h=m[0],t=m[1],f>0&&(h=h.replace(new RegExp("/^[ ]{1,"+f+"}","m"),"")),_+=g?h:"\n\n"+h+"\n\n",h=""}else h+=u}}while(i>0);return _+=e.call(this,h),[_,t]},MarkdownExtra_Parser.prototype.hashClean=function(t){return this.hashPart(t,"C")},MarkdownExtra_Parser.prototype.doHeaders=function(t){function e(t){return"undefined"==typeof t||""==t?"":' id="'+t+'"'}var r=this;return t=t.replace(new RegExp("(^.+?)(?:[ ]+\\{\\#([-_:a-zA-Z0-9]+)\\})?[ ]*\\n(=+|-+)[ ]*\\n+","mg"),function(t,n,a,s){if("-"==s&&n.match(/^- /))return t;var o="="==s.charAt(0)?1:2,i=e(a),h="<h"+o+i+">"+r.runSpanGamut(n)+"</h"+o+">";return"\n"+r.hashBlock(h)+"\n\n"}),t=t.replace(new RegExp("^(\\#{1,6})[ ]*(.+?)[ ]*\\#*(?:[ ]+\\{\\#([-_:a-zA-Z0-9]+)\\})?\\n+","mg"),function(t,n,a,s){var o=n.length,i=e(s),h="<h"+o+i+">"+r.runSpanGamut(a)+"</h"+o+">";return"\n"+r.hashBlock(h)+"\n\n"})},MarkdownExtra_Parser.prototype.doTables=function(t){var e=this,r=this.tab_width-1,n=function(t,r,n,a){r=r.replace(/[|] *$/m,""),n=n.replace(/[|] *$/m,""),a=a.replace(/[|] *$/m,"");var s,o=[],i=n.split(/[ ]*[|][ ]*/);for(s=0;s<i.length;s++){var h=i[s];o[s]=h.match(/^ *-+: *$/)?' align="right"':h.match(/^ *:-+: *$/)?' align="center"':h.match(/^ *:-+ *$/)?' align="left"':""}r=e.parseSpan(r);var _=r.split(/ *[|] */),p=_.length,c="<table>\n";for(c+="<thead>\n",c+="<tr>\n",s=0;s<_.length;s++){var l=_[s];c+="  <th"+o[s]+">"+e.runSpanGamut(e._php_trim(l))+"</th>\n"}c+="</tr>\n",c+="</thead>\n";var u=e._php_trim(a,"\n").split("\n");c+="<tbody>\n";for(var d=0;d<u.length;d++){var f=u[d];f=e.parseSpan(f);for(var g=f.split(/ *[|] */,p);g.length<p;)g.push("");for(c+="<tr>\n",s=0;s<g.length;s++){var E=g[s];c+="  <td"+o[s]+">"+e.runSpanGamut(e._php_trim(E))+"</td>\n"}c+="</tr>\n"}return c+="</tbody>\n",c+="</table>",e.hashBlock(c)+"\n"};return t=this.__wrapSTXETX__(t),t=t.replace(new RegExp("^[ ]{0,"+r+"}[|](.+)\\n[ ]{0,"+r+"}[|]([ ]*[-:]+[-| :]*)\\n((?:[ ]*[|].*\\n)*)(?=\\n|\\x03)","mg"),function(t,e,r,a){return a=a.replace(/^ *[|]/m,""),n.call(this,t,e,r,a)}),t=t.replace(new RegExp("^[ ]{0,"+r+"}(\\S.*[|].*)\\n[ ]{0,"+r+"}([-:]+[ ]*[|][-| :]*)\\n((?:.*[|].*\\n)*)(?=\\n|\\x03)","mg"),n),t=this.__unwrapSTXETX__(t)},MarkdownExtra_Parser.prototype.doDefLists=function(t){var e=this,r=this.tab_width-1,n="(?:(([ ]{0,"+r+"}((?:[ \\t]*\\S.*\\n)+)\\n?[ ]{0,"+r+"}:[ ]+)([\\s\\S]+?)((?=\\0x03)|(?=\\n{2,}(?=\\S)(?![ ]{0,"+r+"}(?:\\S.*\\n)+?\\n?[ ]{0,"+r+"}:[ ]+)(?![ ]{0,"+r+"}:[ ]+)))))";return t=this.__wrapSTXETX__(t),t=t.replace(new RegExp("(\\x02\\n?|\\n\\n)"+n,"mg"),function(t,r,n){var a=e._php_trim(e.processDefListItems(n));return a="<dl>\n"+a+"\n</dl>",r+e.hashBlock(a)+"\n\n"}),t=this.__unwrapSTXETX__(t)},MarkdownExtra_Parser.prototype.processDefListItems=function(t){var e=this,r=this.tab_width-1;return t=this.__wrapSTXETX__(t),t=t.replace(/\n{2,}(?=\\x03)/,"\n"),t=t.replace(new RegExp("(\\x02\\n?|\\n\\n+)([ ]{0,"+r+"}(?![:][ ]|[ ])(?:\\S.*\\n)+?)(?=\\n?[ ]{0,3}:[ ])","mg"),function(t,r,n){for(var a=e._php_trim(n).split("\n"),s="",o=0;o<a.length;o++){var i=a[o];i=e.runSpanGamut(e._php_trim(i)),s+="\n<dt>"+i+"</dt>"}return s+"\n"}),t=t.replace(new RegExp("\\n(\\n+)?([ ]{0,"+r+"}[:][ ]+)([\\s\\S]+?)(?=\\n*(?:\\n[ ]{0,"+r+"}[:][ ]|<dt>|\\x03))","mg"),function(t,r,n,a){return r||a.match(/\n{2,}/)?(a=e._php_str_repeat(" ",n.length)+a,a=e.runBlockGamut(e.outdent(a+"\n\n")),a="\n"+a+"\n"):(a=e._php_rtrim(a),a=e.runSpanGamut(e.outdent(a))),"\n<dd>"+a+"</dd>\n"}),t=this.__unwrapSTXETX__(t)},MarkdownExtra_Parser.prototype.doFencedCodeBlocks=function(t){{var e=this;this.tab_width}return t=this.__wrapSTXETX__(t),t=t.replace(new RegExp("(?:\\n|\\x02)(~{3,})[ ]*\\n((?:(?!\\1[ ]*\\n).*\\n+)+)\\1[ ]*\\n","mg"),function(t,r,n){return n=e._php_htmlspecialchars_ENT_NOQUOTES(n),n=n.replace(/^\n+/,function(t){return e._php_str_repeat("<br"+e.empty_element_suffix,t.length)}),n="<pre><code>"+n+"</code></pre>","\n\n"+e.hashBlock(n)+"\n\n"}),t=this.__unwrapSTXETX__(t)},MarkdownExtra_Parser.prototype.formParagraphs=function(t){t=this.__wrapSTXETX__(t),t=t.replace(/(?:\x02)\n+|\n+(?:\x03)/g,""),t=this.__unwrapSTXETX__(t);for(var e=t.split(/\n{2,}/m),r=0;r<e.length;r++){var n=e[r];if(""!=n){n=this._php_trim(this.runSpanGamut(n));var a=!n.match(/^B\x1A[0-9]+B|^C\x1A[0-9]+C$/);a&&(n="<p>"+n+"</p>"),e[r]=n}}return t=e.join("\n\n"),t=this.unhash(t)},MarkdownExtra_Parser.prototype.stripFootnotes=function(t){var e=this,r=this.tab_width-1;return t=t.replace(new RegExp("^[ ]{0,"+r+"}\\[\\^(.+?)\\][ ]?:[ ]*\\n?((?:.+|\\n(?!\\[\\^.+?\\]:\\s)(?!\\n+[ ]{0,3}\\S))*)","mg"),function(t,r,n){var a=e.fn_id_prefix+r;return e.footnotes[a]=e.outdent(n),""})},MarkdownExtra_Parser.prototype.doFootnotes=function(t){return this.in_anchor||(t=t.replace(/\[\^(.+?)\]/g,"Ffn:$1:")),t},MarkdownExtra_Parser.prototype.appendFootnotes=function(t){var e=this,r=function(t,r){var n=e.fn_id_prefix+r;if(n in e.footnotes){e.footnotes_ordered.push([n,e.footnotes[n]]),delete e.footnotes[n];var a=e.footnote_counter++,s=' rel="footnote"';if(""!=e.fn_link_class){var o=e.fn_link_class;o=e.encodeAttribute(o),s+=' class="'+o+'"'}if(""!=e.fn_link_title){var i=e.fn_link_title;i=e.encodeAttribute(i),s+=' title="'+i+'"'}return s=s.replace(/%%/g,a),n=e.encodeAttribute(n),'<sup id="fnref:'+n+'"><a href="#fn:'+n+'"'+s+">"+a+"</a></sup>"}return"[^"+r+"]"};if(t=t.replace(/F\x1Afn:(.*?)\x1A:/g,r),this.footnotes_ordered.length>0){t+="\n\n",t+='<div class="footnotes">\n',t+="<hr"+this.empty_element_suffix+"\n",t+="<ol>\n\n";var n=' rev="footnote"';if(""!=this.fn_backlink_class){var a=this.fn_backlink_class;a=this.encodeAttribute(a),n+=' class="'+a+'"'}if(""!=this.fn_backlink_title){var s=this.fn_backlink_title;s=this.encodeAttribute(s),n+=' title="'+s+'"'}for(var o=0;this.footnotes_ordered.length>0;){var i=this.footnotes_ordered.shift(),h=i[0],_=i[1];_+="\n",_=this.runBlockGamut(_+"\n"),_=_.replace(/F\x1Afn:(.*?)\x1A:/g,r),n=n.replace(/%%/g,++o),h=this.encodeAttribute(h);var p='<a href="#fnref:'+h+'"'+n+">&#8617;</a>";_.match(/<\/p>$/)?_=_.substr(0,_.length-4)+"&#160;"+p+"</p>":_+="\n\n<p>"+p+"</p>",t+='<li id="fn:'+h+'">\n',t+=_+"\n",t+="</li>\n\n"}t+="</ol>\n",t+="</div>"}return t},MarkdownExtra_Parser.prototype.stripAbbreviations=function(t){var e=this,r=this.tab_width-1;return t=t.replace(new RegExp("^[ ]{0,"+r+"}\\*\\[(.+?)\\][ ]?:(.*)","mg"),function(t,r,n){return""!=e.abbr_word_re&&(e.abbr_word_re+="|"),e.abbr_word_re+=e._php_preg_quote(r),e.abbr_desciptions[r]=e._php_trim(n),""})},MarkdownExtra_Parser.prototype.doAbbreviations=function(t){var e=this;return this.abbr_word_re&&(t=t.replace(new RegExp("(^|[^\\w\\x1A])("+this.abbr_word_re+")(?![\\w\\x1A])","g"),function(t,r,n){if(n in e.abbr_desciptions){var a=e.abbr_desciptions[n];return a&&""!=a?(a=e.encodeAttribute(a),e.hashPart(r+'<abbr title="'+a+'">'+n+"</abbr>")):e.hashPart(r+"<abbr>"+n+"</abbr>")}return t})),t},"undefined"!=typeof exports&&(exports.Markdown=Markdown,exports.Markdown_Parser=Markdown_Parser,exports.MarkdownExtra_Parser=MarkdownExtra_Parser);
var Editor=function(e){var t=this,n=[],a=0,l=null;t.area="undefined"!=typeof e?e:document.getElementsByTagName("textarea")[0],n[a]={value:t.area.value,selectionStart:0,selectionEnd:0},a++,t.selection=function(){var e=t.area.selectionStart,n=t.area.selectionEnd,a=t.area.value.substring(e,n),l=t.area.value.substring(0,e),r=t.area.value.substring(n),o={start:e,end:n,value:a,before:l,after:r};return o},t.select=function(e,n,a){var l=t.area.scrollTop;t.area.focus(),t.area.setSelectionRange(e,n),t.area.scrollTop=l,"function"==typeof a&&a()},t.replace=function(e,n,a){var l=t.selection(),r=l.start,o=(l.end,l.value.replace(e,n));t.area.value=l.before+o+l.after,t.select(r,r+o.length),"function"==typeof a?a():t.updateHistory({value:t.area.value,selectionStart:r,selectionEnd:r+o.length})},t.insert=function(e,n){{var a=t.selection(),l=a.start;a.end}t.area.value=a.before+e+a.after,t.select(l+e.length,l+e.length),"function"==typeof n?n():t.updateHistory({value:t.area.value,selectionStart:l+e.length,selectionEnd:l+e.length})},t.wrap=function(e,n,a){var l=t.selection(),r=l.value,o=l.before,u=l.after;t.area.value=o+e+r+n+u,t.select(o.length+e.length,o.length+e.length+r.length),"function"==typeof a?a():t.updateHistory({value:t.area.value,selectionStart:o.length+e.length,selectionEnd:o.length+e.length+r.length})},t.indent=function(e,n){var a=t.selection();a.value.length>0?t.replace(/(^|\n)([^\n])/gm,"$1"+e+"$2",n):(t.area.value=a.before+e+a.value+a.after,t.select(a.start+e.length,a.start+e.length),"function"==typeof n?n():t.updateHistory({value:t.area.value,selectionStart:a.start+e.length,selectionEnd:a.start+e.length}))},t.outdent=function(e,n){var a=t.selection();if(a.value.length>0)t.replace(new RegExp("(^|\n)"+e,"gm"),"$1",n);else{var l=a.before.replace(new RegExp(e+"$"),"");t.area.value=l+a.value+a.after,t.select(l.length,l.length),"function"==typeof n?n():t.updateHistory({value:t.area.value,selectionStart:l.length,selectionEnd:l.length})}},t.callHistory=function(e){return"number"==typeof e?n[e]:n},t.updateHistory=function(e,l){var r="undefined"!=typeof e?e:{value:t.area.value,selectionStart:t.selection().start,selectionEnd:t.selection().end};n["number"==typeof l?l:a]=r,a++},t.undo=function(e){if(n.length>1){a>1?a--:a=1;var r=t.callHistory(a-1);l=0>=a?a-1:a,t.area.value=r.value,t.select(r.selectionStart,r.selectionEnd),"function"==typeof e&&e()}},t.redo=function(e){if(null!==l){var r=t.callHistory(l);l<n.length-1?l++:l=n.length-1,a=l>=n.length-1?l+1:l,t.area.value=r.value,t.select(r.selectionStart,r.selectionEnd),"function"==typeof e&&e()}}};
;var MTE=function(a,b){function j(a,b){a=a||{};for(var c in b)a[c]="object"==typeof b[c]?j(a[c],b[c]):b[c];return a}var c=this,d=window,e=document,f=new Editor(a),g={tabSize:"    ",toolbar:!0,shortcut:!1,toolbarClass:"editor-toolbar",toolbarPosition:"before",buttonClassPrefix:"editor-toolbar-button editor-toolbar-button-",iconClassPrefix:"fa fa-",buttons:{ok:"OK",yes:"Yes",no:"No",cancel:"Cancel",open:"Open",close:"Close",bold:"Bold",italic:"Italic",code:"Code",quote:"Quote",heading:"H1 \u2013 H6",link:"Link",image:"Image",ol:"Ordered List",ul:"Unordered List",rule:"Horizontal Rule",undo:"Undo",redo:"Redo"},prompt:{link_title:"link title goes here...",link_title_title:"Link Title",link_url:"http://",link_url_title:"Link URL",image_url:"http://",image_url_title:"Image URL"},placeholder:{heading_text:"Heading",link_text:"link text",list_ul_text:"List Item",list_ol_text:"List Item",image_alt:"Image"},keydown:function(){},click:function(){},ready:function(){}},h=e.createElement("div"),i=e.createElement("div");c.modal=function(a,b){a=a||"modal";var f=e.body,g=f.scrollTop||e.documentElement.scrollTop;h.className="custom-modal-overlay custom-modal-"+a+"-overlay",h.onclick=function(){c.close(!0)},i.className="custom-modal custom-modal-"+a,i.innerHTML='<div class="custom-modal-header custom-modal-'+a+'-header"></div><div class="custom-modal-content custom-modal-'+a+'-content"></div><div class="custom-modal-action custom-modal-'+a+'-action"></div>',i.style.visibility="hidden",f.appendChild(h),f.appendChild(i),d.setTimeout(function(){var a=i.offsetWidth,b=i.offsetHeight;i.style.position="absolute",i.style.top="50%",i.style.left="50%",i.style.zIndex="9999",i.style.marginTop=g-b/2+"px",i.style.marginLeft="-"+a/2+"px",i.style.visibility="",i.offsetTop<0&&(i.style.top=0,i.style.marginTop=0),i.offsetLeft<0&&(i.style.left=0,i.style.marginLeft=0)},10),"function"==typeof b&&b(h,i)},c.close=function(a){if(h&&e.body.removeChild(h),i&&e.body.removeChild(i),"undefined"!=typeof a&&a===!0){var b=f.selection();f.select(b.start,b.end)}},c.prompt=function(a,b,f,g){c.modal("prompt",function(h,i){var j=function(a){"function"==typeof g?(c.close(),g(a)):c.close(!0)},l=e.createElement("input");l.type="text",l.value=b,l.onkeyup=function(a){f?13==a.keyCode&&""!==this.value&&this.value!==b&&j(this.value):13==a.keyCode&&j(this.value==b?"":this.value)};var m=e.createElement("button");m.innerHTML=k.buttons.ok,m.onclick=function(){f?""!==l.value&&l.value!==b&&j(l.value):j(l.value==b?"":l.value)};var n=e.createElement("button");n.innerHTML=k.buttons.cancel,n.onclick=function(){c.close(!0)},i.children[0].innerHTML=a?a:"",i.children[1].appendChild(l),i.children[2].appendChild(m),i.children[2].appendChild(e.createTextNode(" ")),i.children[2].appendChild(n),d.setTimeout(function(){l.select()},10)})},c.alert=function(a,b,d){c.modal("alert",function(f,g){var h=e.createElement("button");h.innerHTML=k.buttons.ok,h.onclick=function(){"function"==typeof d?(c.close(),d()):c.close(!0)},g.children[0].innerHTML=a?a:"",g.children[1].innerHTML=b?b:"",g.children[2].appendChild(h)})},c.confirm=function(a,b,d){c.modal("confirm",function(f,g){var h=e.createElement("button");h.innerHTML=k.buttons.ok,h.onclick=function(){"undefined"==typeof d?c.close(!0):"function"==typeof d.OK?(c.close(),d.OK()):c.close(!0)};var i=e.createElement("button");i.innerHTML=k.buttons.cancel,i.onclick=function(){return"undefined"==typeof d?c.close(!0):"function"==typeof d.CANCEL?(c.close(),d.CANCEL()):c.close(!0),!1},g.children[0].innerHTML=a?a:"",g.children[1].innerHTML=b?b:"",g.children[2].appendChild(h),g.children[2].appendChild(e.createTextNode(" ")),g.children[2].appendChild(i)})};var k=j(g,b),l=e.createElement("span");k.toolbar&&(l.className=k.toolbarClass,f.area.parentNode.insertBefore(l,"before"==k.toolbarPosition?f.area:null)),c.button=function(a,b){if(b.title!==!1){var d=e.createElement("a");d.className=k.buttonClassPrefix+a,d.href="#"+a.replace(" ",":").replace(/[^a-z0-9\:]/gi,"-").replace(/-+/g,"-").replace(/^-+|-+$/,""),d.setAttribute("tabindex",-1),d.innerHTML='<i class="'+k.iconClassPrefix+a+'"></i>',d.onclick=function(a){return b.click(a,c),k.click(a,c,this.hash.replace("#","")),!1},b.title&&(d.title=b.title),b.position?l.insertBefore(d,l.children[b.position-1]):l.appendChild(d)}},f.toggle=function(a,b,c){var d=f.selection();if(d.before.slice(-a.length)!=a&&d.after.slice(0,b.length)!=b)f.wrap(a,b);else{var e=d.before.slice(-a.length)==a?d.before.substring(0,d.before.length-a.length):d.before,g=d.after.substring(0,b.length)==b?d.after.substring(b.length):d.after;f.area.value=e+d.value+g,f.select(e.length,e.length+d.value.length,function(){f.updateHistory()})}"function"==typeof c&&c()};var m=0,n=k.buttons,o={bold:{title:n.bold,click:function(){f.toggle("**","**")}},italic:{title:n.italic,click:function(){f.toggle("_","_")}},code:{title:n.code,click:function(){var a=f.selection().value;-1!==a.indexOf("\n")&&a.length>0?f.indent(k.tabSize):f.toggle("`","`")}},"quote-right":{title:n.quote,click:function(){f.indent("> ")}},header:{title:n.heading,click:function(){var a=f.selection(),b=["","# ","## ","### ","#### ","##### ","###### "];if(m=m<b.length-1?m+1:0,a.value.length>0)if(a.before.match(/\#+ $/)){var c=a.before.replace(/\#+ $/,""),d=a.value.replace(/^\#+ /,"");f.area.value=c+b[m]+d+a.after,f.select(c.length+b[m].length,c.length+b[m].length+d.length,function(){f.updateHistory()})}else f.wrap(b[m],"",function(){f.replace(/^\#+ /,"")});else{var e=k.placeholder.heading_text;m=1,f.insert(b[m]+e,function(){a=f.selection().end,f.select(a-e.length-b[m].length+2,a,function(){f.updateHistory()})})}}},link:{title:n.link,click:function(){var b,d,a=f.selection(),e=k.placeholder.link_text;c.prompt(k.prompt.link_title_title,k.prompt.link_title,!1,function(g){b=g,c.prompt(k.prompt.link_url_title,k.prompt.link_url,!0,function(c){d=c,f.wrap("["+(0===a.value.length?e:""),"]("+d+(""!==b?' "'+b+'"':"")+")",function(){f.select(a.start+1,0===a.value.length?a.start+e.length+1:a.end+1,function(){f.updateHistory()})})})})}},image:{title:n.image,click:function(){c.prompt(k.prompt.image_url_title,k.prompt.image_url,!0,function(a){var b=decodeURIComponent(a.substring(a.lastIndexOf("/")+1,a.lastIndexOf(".")).replace(/[\-\+\.\_]+/g," ")).toLowerCase().replace(/(?:^|\s)\S/g,function(a){return a.toUpperCase()});b=-1===b.indexOf("/")&&-1!==a.indexOf(".")?b:k.placeholder.image_alt,f.insert("\n!["+b+"]("+a+")\n")})}},"list-ol":{title:n.ol,click:function(){var a=f.selection(),b=0,c="";if(a.value==k.placeholder.list_ol_text)f.select(a.start,a.end);else if(a.value.length>0)f.indent("",function(){f.replace(/^[^\n\r]/gm,function(a){return b++,c+=" "+b+". ",a.replace(/^/," "+b+". ")})});else{var d=" 1. "+k.placeholder.list_ol_text;f.insert(d,function(){f.select(a.start+4,a.start+d.length,function(){f.updateHistory()})})}}},"list-ul":{title:n.ul,click:function(){var a=f.selection();if(a.value==k.placeholder.list_ul_text)f.select(a.start,a.end);else if(a.value.length>0)f.indent(" * ");else{var b=" * "+k.placeholder.list_ul_text;f.insert(b,function(){f.select(a.start+3,a.start+b.length,function(){f.updateHistory()})})}}},"ellipsis-h":{title:n.rule,click:function(){f.insert("\n---\n")}},undo:{title:n.undo,click:function(){f.undo()}},repeat:{title:n.redo,click:function(){f.redo()}}};for(var p in o)c.button(p,o[p]);var q=function(a,b){return f.insert(a,function(){f.select(b.end+1,b.end+1)}),!1};f.area.onkeydown=function(a){var b=f.selection(),e=a.keyCode,g=a.ctrlKey,h=a.shiftKey,i=a.altKey;d.setTimeout(function(){k.keydown(a,c)},10);var j=b.before,l=b.after[0];if(-1!==j.indexOf("(")&&h&&48==e&&")"==l&&"\\"!=j.slice(-1)||-1!==j.indexOf("{")&&h&&221==e&&"}"==l&&"\\"!=j.slice(-1)||-1!==j.indexOf("[")&&221==e&&"]"==l&&"\\"!=j.slice(-1)||-1!==j.indexOf('"')&&h&&222==e&&'"'==l&&"\\"!=j.slice(-1)||-1!==j.indexOf("'")&&!h&&222==e&&"'"==l&&"\\"!=j.slice(-1)||-1!==j.indexOf("`")&&!h&&192==e&&"`"==l&&"\\"!=j.slice(-1)||-1!==j.indexOf("<")&&h&&190==e&&">"==l&&"\\"!=j.slice(-1))return f.select(b.end+1,b.end+1),!1;if(h&&57==e)return q("("+b.value+")",b);if(h&&219==e)return q("{"+b.value+"}",b);if(!h&&219==e)return q("["+b.value+"]",b);if(h&&222==e)return q('"'+b.value+'"',b);if(!h&&222==e)return q("'"+b.value+"'",b);if(!h&&192==e)return q("`"+b.value+"`",b);if(h&&188==e)return q("<"+b.value+">",b);if(h&&9==e)return f.outdent("( *[0-9]+. | *[\\-\\+\\*] |> |"+k.tabSize+")"),!1;if(9==e)return f.indent(k.tabSize),!1;if(g&&90==e)return f.undo(),!1;if(g&&89==e||g&&82==e)return f.redo(),!1;if(k.shortcut){if(g&&66==e)return o.bold.click(),!1;if(g&&73==e)return o.italic.click(),!1;if(g&&81==e)return o["quote-right"].click(),!1;if(i&&81==e)return h?f.toggle("&ldquo;","&rdquo;"):f.toggle("&lsquo;","&rsquo;"),!1;if(g&&72==e)return o.header.click(),!1;if(g&&76==e)return o.link.click(),!1;if(g&&71==e)return o.image.click(),!1}if(32==e){var m=/(^|\n)([0-9]+\.|[\-\+\*])$/;if(b.before.match(m))return f.area.value=b.before.replace(m,"$1 $2 ")+b.value+b.after,f.select(b.end+2,b.end+2,function(){f.updateHistory()}),!1}if(13==e){var n=/(^|\n)( *?)([0-9]+\.|[\-\+\*]) (.*?)$/;if(b.before.match(n)){var p=n.exec(b.before),r=/[0-9]+\./.test(p[3])?parseInt(p[3],10)+1+".":p[3];return f.insert("\n"+p[2]+r+" ",null),!1}var s=new RegExp("(^|\n)(("+k.tabSize+")+)(.*?)$").exec(b.before),t=s?s[2]:"";return b.before.match(/[\(\{\[]$/)&&b.after.match(/^[\]\}\)]/)||b.before.match(/<[^\/]*?>$/)&&b.after.match(/^<\//)?(f.insert("\n"+t+k.tabSize+"\n"+t,function(){f.select(b.start+t.length+k.tabSize.length+1,b.start+t.length+k.tabSize.length+1,function(){f.updateHistory()})}),!1):(f.insert("\n"+t),!1)}if(8==e&&0===b.value.length){if(b.before.match(/( *?)([0-9]+\.|[\-\+\*]) $/))return f.outdent("( *?)([0-9]+.|[-+*]) "),!1;if(b.before.match(new RegExp(k.tabSize+"$")))return f.outdent(k.tabSize),!1;switch(b.before.slice(-1)){case"(":return f.toggle("(",")"),!1;case"{":return f.toggle("{","}"),!1;case"[":return f.toggle("[","]"),!1;case'"':return f.toggle('"','"'),!1;case"'":return f.toggle("'","'"),!1;case"<":return f.toggle("<",">"),!1;case"*":return f.toggle("*","*"),!1;case"_":return f.toggle("_","_"),!1;case"~":return f.toggle("~","~"),!1;case"`":return f.toggle("`","`"),!1}}f.updateHistory()},k.ready(c),c.grip=f,c.grip.config=k};


       // my custom sample
    (function() {

        var textarea = document.querySelector('#editor-area'),
            preview = document.querySelector('#editor-preview');

            if(!textarea) return false;

        // Initiation
        var editor = new MTE(document.getElementById('editor-area'), {
            tabSize: '    ',
            shortcut: true,
            toolbarPosition: "before",
            keydown: updatePreview,
            click: updatePreview,
            ready: updatePreview
        });


        editor.button('scissors', {
            title: '{cut}',
            click: function(e, base) {
                base.grip.insert('{cut}');
            }
        });


        /*
        // Example Custom Buttons
        editor.button('strikethrough another-class-goes-here another-another-class-goes-here', {
            title: 'Strike',
            position: 3,
            click: function(e, base) {
                base.grip.toggle('~~', '~~');
            }
        });
        editor.button('warning', {
            title: 'Example Alert Box',
            click: function(e, base) {
                base.alert('Alert Box', 'This is an alert box!');
            }
        });
        editor.button('question-circle', {
            title: 'Example Confirm Box',
            click: function(e, base) {
                base.confirm('Confirm Box', 'This is a confirm box!', {
                    OK: function() {
                        alert('Confirmed!');
                    },
                    CANCEL: function() {
                        alert('Cancelled!');
                    }
                });
            }
        });
        editor.button('pencil', {
            title: 'Example Custom Modal',
            click: function(e, base) {
                base.modal('my-modal', function(overlay, modal) {
                    var btn = document.createElement('button');
                    btn.innerHTML = 'Save';
                    btn.onclick = function() {
                        alert('Saved!');
                        base.close(true);
                        return false;
                    };
                    modal.children[0].innerHTML = 'Test Modal'; // Header
                    modal.children[1].innerHTML = '<img src="http://lorempixel.com/600/200/animals">'; // Content
                    modal.children[2].appendChild(btn); // Footer
                });
            }
        });
		*/

        function updatePreview(e) {
            var toHTML = Markdown(textarea.value);
            preview.innerHTML = toHTML.replace(/<table>/gi, '<table border="1">');
        }


    })();